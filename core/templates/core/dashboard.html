{% extends "core/base.html" %}

{% block content %}
<h2>Dashboard</h2>

<h3>Minhas Empresas (como criador)</h3>
<ul>
{% for empresa in empresas %}
    {% if empresa.criador == user %}
    <li>
        <a href="{% url 'core:empresa_detail' empresa.id %}">
            {{ empresa.nome }}
        </a>
        <span class="badge badge-creator">Criador da Empresa</span>
    </li>
    {% endif %}
{% empty %}
    <li class="empty-state">Nenhuma empresa criada por você</li>
{% endfor %}
</ul>

<h3>Empresas onde participo</h3>
<ul>
{% for empresa in empresas %}
    {% if empresa.criador != user %}
    <li>
        <a href="{% url 'core:empresa_detail' empresa.id %}">
            {{ empresa.nome }}
        </a>
        
        {# Verificar o tipo de participação usando filtros simples #}
        {% for projeto in empresa.projetos.all %}
            {% if projeto.criador == user %}
                <span class="badge badge-creator">Criador do Projeto</span>
            {% elif user in projeto.membros.all %}
                <span class="badge badge-member">Membro do Projeto</span>
            {% endif %}
        {% endfor %}
    </li>
    {% endif %}
{% empty %}
    <li class="empty-state">Não há empresas em que participo</li>
{% endfor %}
</ul>

<div style="margin-top: 30px;">
    <a href="{% url 'core:empresa_create' %}" class="btn btn-primary">Criar nova empresa</a>
    <a href="{% url 'core:projeto_create_global' %}" class="btn btn-primary">Criar novo projeto</a>
</div>

{% endblock %}