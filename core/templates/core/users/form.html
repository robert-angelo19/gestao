{% extends "core/base.html" %}

{% block content %}
<h2>{% if form.instance.pk %}Editar Usuário{% else %}Novo Usuário{% endif %}</h2>

<form method="post">
    {% csrf_token %}
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
        <div>
            <label for="id_username">Username *</label>
            {{ form.username }}
            {% if form.username.errors %}
                <div style="color: #dc3545; font-size: 0.875rem;">{{ form.username.errors }}</div>
            {% endif %}
        </div>
        
        <div>
            <label for="id_email">Email *</label>
            {{ form.email }}
            {% if form.email.errors %}
                <div style="color: #dc3545; font-size: 0.875rem;">{{ form.email.errors }}</div>
            {% endif %}
        </div>
        
        <div>
            <label for="id_first_name">Primeiro Nome</label>
            {{ form.first_name }}
        </div>
        
        <div>
            <label for="id_last_name">Sobrenome</label>
            {{ form.last_name }}
        </div>
        
        {% if not form.instance.pk %}
        <div>
            <label for="id_password1">Senha *</label>
            {{ form.password1 }}
            {% if form.password1.errors %}
                <div style="color: #dc3545; font-size: 0.875rem;">{{ form.password1.errors }}</div>
            {% endif %}
        </div>
        
        <div>
            <label for="id_password2">Confirmar Senha *</label>
            {{ form.password2 }}
            {% if form.password2.errors %}
                <div style="color: #dc3545; font-size: 0.875rem;">{{ form.password2.errors }}</div>
            {% endif %}
        </div>
        {% endif %}
        
        {% if form.instance.pk %}
        <div>
            <label for="id_is_active">Ativo</label>
            {{ form.is_active }}
        </div>
        {% endif %}
    </div>
    
    <button type="submit" class="btn btn-primary">Salvar</button>
    <a href="{% url 'core:user_list' %}" class="btn btn-secondary">Cancelar</a>

    <style>
    /* esconder asteriscos de campos n obrigatorio */
    label[for="id_email"] .required,
    label[for="id_first_name"] .required, 
    label[for="id_last_name"] .required {
        display: none !important;
    }
    </style>

    <script>
    // remover asteriscos por js
    document.addEventListener('DOMContentLoaded', function() {
    // Remover * do email
    const emailLabel = document.querySelector('label[for="id_email"]');
    if (emailLabel) {
        emailLabel.innerHTML = emailLabel.innerHTML.replace(' *', '');
    }
    
    // Remover * do first_name
    const firstNameLabel = document.querySelector('label[for="id_first_name"]');
    if (firstNameLabel) {
        firstNameLabel.innerHTML = firstNameLabel.innerHTML.replace(' *', '');
    }
    
    // Remover * do last_name  
    const lastNameLabel = document.querySelector('label[for="id_last_name"]');
    if (lastNameLabel) {
        lastNameLabel.innerHTML = lastNameLabel.innerHTML.replace(' *', '');
    }
    });
    </script>

</form>
{% endblock %}